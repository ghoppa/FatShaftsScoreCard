<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Fat Shafts Archery Scorecard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
html, body {
  height: 100%;
  margin: 0;
  padding: 0;
}

body {
  font-family: Arial, sans-serif;
  background: #f4f6f8;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: space-between;
  text-align: center;
}

/* Header */
h1 {
  font-size: 4vmin;
  margin: 0.5vmin 0;
}
p {
  font-size: 3vmin;
  margin: 0.5vmin 0;
}

/* Table container takes top ~2/3 of screen */
.table-container {
  width: 95%;
  flex: 1 1 auto;
  overflow-y: hidden;
  display: flex;
  flex-direction: column;
}

table {
  width: 100%;
  border-collapse: collapse;
  font-size: 3vmin;
  table-layout: fixed;
  flex: 1;
}

td {
  border: 1px solid #ccc;
  text-align: center;
  vertical-align: middle;
  word-wrap: break-word;
  font-size: 6vmin;   /* arrow scores bigger, ~80% of cell */
  line-height: 1;     /* vertical centering */
}

th {
  background: #2c3e50;
  color: white;
  font-size: 3vmin;   /* keep header size same as previous version */
}

.end-total, .running-total {
  font-weight: bold;
  background: #ecf0f1;
}

/* Running totals display */
#grandTotal {
  font-size: 3.5vmin;
  font-weight: bold;
  margin: 2px 0;
}

/* Buttons grid takes 1/3 of screen height */
.buttons-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 6px;
  width: 95%;
  height: 25vh; /* occupy 1/3 of viewport height */
}

button {
  font-size: 4vmin;
  height: 100%; /* fill each grid cell */
  border-radius: 8px;
  border: none;
  cursor: pointer;
}

/* Button colors */
.x { background: gold; font-weight: bold; }
.score { background: #3498db; color: white; }
.clear { background: #e74c3c; color: white; }
.print {
  background: #2ecc71;
  color: white;
  width: 95%;
  margin-top: 4px;
  font-size: 4vmin;
  height: 6vh; /* slightly shorter than grid buttons */
}

/* Responsive adjustments for very small screens */
@media (max-width: 480px) {
  table { font-size: 2.5vmin; }
  button { font-size: 3.5vmin; }
  .print { font-size: 3.5vmin; }
}

/* Print CSS */
@media print {
  body { background: white; }
  .buttons-grid, .print, #grandTotal { display: none; }
  table { page-break-inside: avoid; }
  th, td { border: 1px solid #000; padding: 2px; }
}
</style>
</head>
<body>

<h1>Fat Shafts Archery Scorecard<</h1>
<p>3 arrows per end · 10 ends</p>

<div class="table-container">
  <table>
    <thead>
      <tr>
        <th>End</th>
        <th>Arrow 1</th>
        <th>Arrow 2</th>
        <th>Arrow 3</th>
        <th>End Total</th>
        <th>Running Total</th>
      </tr>
    </thead>
    <tbody id="scoreTable"></tbody>
  </table>
</div>

<div id="grandTotal">Total Score: 0</div>

<!-- Buttons grid 3x4 -->
<div class="buttons-grid">
  <button class="x" onclick="addScore(10,true)">X</button>
  <button class="score" onclick="addScore(10)">10</button>
  <button class="score" onclick="addScore(9)">9</button>
  <button class="score" onclick="addScore(8)">8</button>
  <button class="score" onclick="addScore(7)">7</button>
  <button class="score" onclick="addScore(6)">6</button>
  <button class="score" onclick="addScore(5)">5</button>
  <button class="score" onclick="addScore(4)">4</button>
  <button class="score" onclick="addScore(3)">3</button>
  <button class="score" onclick="addScore(2)">2</button>
  <button class="score" onclick="addScore(1)">1</button>
  <button class="clear" onclick="clearEnd()">Clear</button>
</div>

<!-- Print button always at bottom -->
<button class="print" onclick="window.print()">Print Scorecard</button>

<script>
const tableBody = document.getElementById("scoreTable");
const grandTotalEl = document.getElementById("grandTotal");

let currentEnd = 0;
let currentArrow = 0;
const scores = [];
const display = [];

// Build table rows
for(let i=0;i<10;i++){
  scores.push([]);
  display.push([]);
  const row = document.createElement("tr");
  row.innerHTML = `
    <td>${i+1}</td>
    <td id="e${i}a0"></td>
    <td id="e${i}a1"></td>
    <td id="e${i}a2"></td>
    <td id="e${i}t" class="end-total">0</td>
    <td id="e${i}r" class="running-total">0</td>
  `;
  tableBody.appendChild(row);
}

// Add score
function addScore(value,isX=false){
  if(currentEnd>=10) return;
  scores[currentEnd].push(value);
  display[currentEnd].push(isX?"X":value);
  sortAndRender(currentEnd);
  currentArrow++;
  if(currentArrow===3){currentArrow=0; currentEnd++;}
  calculateTotals();
}

// Correct sorting: X → 10 → 9 → 8 → … → lowest
function sortAndRender(endIndex){
  const combined = scores[endIndex].map((v,i)=>({value:v,label:display[endIndex][i]}));
  combined.sort((a,b)=>{
    if(a.label==="X") return -1;  // X first
    if(b.label==="X") return 1;
    return b.value - a.value;      // then numeric descending
  });
  scores[endIndex] = combined.map(x=>x.value);
  display[endIndex] = combined.map(x=>x.label);
  for(let i=0;i<3;i++){
    document.getElementById(`e${endIndex}a${i}`).textContent = display[endIndex][i]||"";
  }
}

// Clear end
function clearEnd(){
  let endToClear = currentArrow===0 && currentEnd>0 ? currentEnd-1 : currentEnd;
  if(endToClear<0 || endToClear>=10) return;
  scores[endToClear]=[];
  display[endToClear]=[];
  for(let i=0;i<3;i++){
    document.getElementById(`e${endToClear}a${i}`).textContent="";
  }
  document.getElementById(`e${endToClear}t`).textContent="0";
  document.getElementById(`e${endToClear}r`).textContent="0";
  currentEnd=endToClear;
  currentArrow=0;
  calculateTotals();
}

// Totals
function calculateTotals(){
  let grandTotal=0;
  scores.forEach((end,e)=>{
    let endTotal=end.reduce((sum,v)=>sum+v,0);
    document.getElementById(`e${e}t`).textContent=endTotal;
    grandTotal+=endTotal;
    document.getElementById(`e${e}r`).textContent=grandTotal;
  });
  grandTotalEl.textContent=`Total Score: ${grandTotal}`;
}
</script>

</body>
</html>





